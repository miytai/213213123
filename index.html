<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hebrew Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        .word {
            color: #3390ec;
            cursor: pointer;
            padding: 2px 4px;
        }
        .word:hover {
            background: rgba(51, 144, 236, 0.1);
        }
    </style>
</head>
<body>
    <div id="text"></div>

    <script>
        const tg = WebApp;
        tg.expand();
        
        // Получаем текст из URL
        const url = new URL(window.location.href);
        const text = url.searchParams.get('text') || "שלום עולם";
        
        // Отображаем текст с кликабельными словами
        const words = text.split(/([\w']+)/);
        const textEl = document.getElementById('text');
        
        words.forEach(word => {
            if (/[\w']+/.test(word)) {
                const span = document.createElement('span');
                span.className = 'word';
                span.textContent = word;
                span.onclick = () => analyzeWord(word);
                textEl.appendChild(span);
            } else {
                textEl.appendChild(document.createTextNode(word));
            }
        });
        
        async function analyzeWord(word) {
            tg.showPopup({
                title: 'Analyzing...',
                message: `Word: ${word}`
            }, () => {});
            
            try {
                const response = await fetch('https://your-server.com/api/analyze', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ word })
                });
                
                const data = await response.json();
                
                tg.showAlert(`Word: ${word}\n\nTranslation: ${data.translation}\n\nExplanation: ${data.explanation}`);
            } catch (error) {
                tg.showAlert(`Error: ${error.message}`);
            }
        }
    </script>
</body>
</html>
